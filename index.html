<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="theme-color" content="#000000">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<title>Calculadora</title>

<style>
:root{
  --bg:#000;
  --key-dark:#333;
  --key-fn:#a5a5a5;
  --key-op:#ff9f0a;
  --key-op-press:#ffb84d;
  --text:#fff;
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display","SF Pro Text",system-ui;
}

*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{margin:0;height:100%;background:var(--bg);color:var(--text)}

body{
  display:flex;
  align-items:center;
  justify-content:center;
  padding:env(safe-area-inset-top) env(safe-area-inset-right)
          env(safe-area-inset-bottom) env(safe-area-inset-left);
}

.calculator{
  width:min(420px,95vw);
  background:#000;
  padding:18px;
}

.display{
  height:120px;
  display:flex;
  align-items:flex-end;
  justify-content:flex-end;
  padding-bottom:10px;
}

.display span{
  font-size:64px;
  font-weight:300;
  letter-spacing:-0.02em;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.keys{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:14px;
}

button{
  border:none;
  border-radius:999px;
  height:74px;
  font-size:30px;
  cursor:pointer;
}

button:active{filter:brightness(1.15)}

.key-num{background:var(--key-dark);color:#fff}
.key-fn{background:var(--key-fn);color:#000}
.key-op{background:var(--key-op);color:#fff}
.key-op:active{background:var(--key-op-press)}

.zero{
  grid-column:span 2;
  text-align:left;
  padding-left:28px;
}

@media(max-width:380px){
  .display span{font-size:56px}
  button{height:68px;font-size:28px}
}
</style>
</head>

<body>

<div class="calculator">
  <div class="display"><span id="display">0</span></div>

  <div class="keys">
    <button class="key-fn" data-action="ac">AC</button>
    <button class="key-fn" data-action="sign">±</button>
    <button class="key-fn" data-action="percent">%</button>
    <button class="key-op" data-op="÷">÷</button>

    <button class="key-num" data-num="7">7</button>
    <button class="key-num" data-num="8">8</button>
    <button class="key-num" data-num="9">9</button>
    <button class="key-op" data-op="×">×</button>

    <button class="key-num" data-num="4">4</button>
    <button class="key-num" data-num="5">5</button>
    <button class="key-num" data-num="6">6</button>
    <button class="key-op" data-op="−">−</button>

    <button class="key-num" data-num="1">1</button>
    <button class="key-num" data-num="2">2</button>
    <button class="key-num" data-num="3">3</button>
    <button class="key-op" data-op="+">+</button>

    <button class="key-num zero" data-num="0">0</button>
    <button class="key-num" data-action="dot">.</button>
    <button class="key-op" data-action="equals">=</button>
  </div>
</div>

<script>
const d=document.getElementById("display");
let a=null,b=null,op=null,typing=false,lastEq=false;

const fmt=n=>{
  if(!isFinite(n))return"Error";
  let s=n.toString();
  return s.length<=12?s:n.toExponential(6);
};

const set=t=>d.textContent=t;
const val=()=>Number(d.textContent);

function clearAll(){a=b=op=null;typing=lastEq=false;set("0")}
function digit(n){
  if(lastEq){clearAll();typing=true;set(n);return}
  if(!typing||d.textContent==="0"){typing=true;set(n);return}
  if(d.textContent.length<14)set(d.textContent+n)
}
function dot(){if(!d.textContent.includes("."))set(d.textContent+".")}
function sign(){set(fmt(-val()))}
function percent(){set(fmt(val()/100))}
function choose(o){
  if(a===null){a=val();op=o;typing=false;return}
  if(typing)equals()
  op=o
}
function equals(){
  if(op===null)return
  b=val()
  let r
  switch(op){
    case"+":r=a+b;break
    case"−":r=a-b;break
    case"×":r=a*b;break
    case"÷":r=b===0?NaN:a/b;break
  }
  set(fmt(r))
  a=r;typing=false;lastEq=true
}

document.addEventListener("click",e=>{
  const b=e.target.closest("button")
  if(!b)return
  if(b.dataset.num)digit(b.dataset.num)
  if(b.dataset.op)choose(b.dataset.op)
  switch(b.dataset.action){
    case"ac":clearAll();break
    case"dot":dot();break
    case"sign":sign();break
    case"percent":percent();break
    case"equals":equals();break
  }
})
</script>

</body>
</html>
